# DivineSense v0.91.0 - Chat Apps Integration Release Notes

> **Release Date**: 2026-02-03
> **Issue**: [#53](https://github.com/hrygo/divinesense/issues/53)
> **Pull Request**: [#64](https://github.com/hrygo/divinesense/pull/64)

---

## æ¦‚è¿°

DivineSense v0.91.0 å¼•å…¥**èŠå¤©åº”ç”¨é›†æˆ**åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ Telegramã€WhatsAppã€é’‰é’‰ç­‰å¸¸ç”¨èŠå¤©å¹³å°ç›´æ¥ä¸ DivineSense AI åŠ©æ‰‹äº¤äº’ã€‚è¿™æ˜¯ç»§ Geek Mode å’Œ Evolution Mode ä¹‹åï¼Œ DivineSense AI ä»£ç†èƒ½åŠ›çš„åˆä¸€æ¬¡é‡è¦æ‰©å±•ã€‚

---

## æ–°å¢åŠŸèƒ½

### ğŸ¤– å¤šå¹³å°èŠå¤©åº”ç”¨æ¥å…¥

| å¹³å° | ç±»å‹ | æ”¯æŒçŠ¶æ€ |
|:-----|:-----|:---------|
| **Telegram** | Bot API | âœ… å®Œå…¨æ”¯æŒ |
| **WhatsApp** | Baileys æ¡¥æ¥ | âœ… å®Œå…¨æ”¯æŒ |
| **é’‰é’‰** | ä¼ä¸šæœºå™¨äºº | âœ… å®Œå…¨æ”¯æŒ |

### ğŸ” å®‰å…¨åŠ å›º

- **AES-256-GCM åŠ å¯†**ï¼šæ‰€æœ‰è®¿é—®ä»¤ç‰Œä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨
- **å¯åŠ¨æ—¶éªŒè¯**ï¼šæœåŠ¡å¯åŠ¨æ—¶éªŒè¯åŠ å¯†å¯†é’¥é…ç½®ï¼Œå¤±è´¥å¿«é€ŸæŠ¥é”™
- **è¾“å…¥éªŒè¯**ï¼šå¹³å°ç™½åå• + å­—æ®µé•¿åº¦é™åˆ¶ï¼ˆé˜²æ³¨å…¥ï¼‰
- **Webhook ç­¾åéªŒè¯**ï¼š
  - é’‰é’‰ï¼šHMAC-SHA256 + æ—¶é—´æˆ³éªŒè¯ï¼ˆ5åˆ†é’Ÿçª—å£ï¼Œé˜²é‡æ”¾æ”»å‡»ï¼‰
  - Telegramï¼šBot Token åŒ¹é…éªŒè¯
  - WhatsAppï¼šæ¡¥æ¥æœåŠ¡è¿æ¥çŠ¶æ€æ£€æŸ¥
- **å¹¶å‘å®‰å…¨**ï¼šä¿®å¤ Token ç¼“å­˜ç«æ€æ¡ä»¶

### ğŸ“ å‰ç«¯ç®¡ç†ç•Œé¢

- è®¾ç½®é¡µé¢æ–°å¢ã€ŒèŠå¤©åº”ç”¨ã€é…ç½®é¢æ¿
- æ”¯æŒå‡­è¯æ³¨å†Œã€åˆ é™¤ã€å¯ç”¨/ç¦ç”¨
- Webhook URL è‡ªåŠ¨ç”Ÿæˆ
- å®Œæ•´çš„ i18n æ”¯æŒï¼ˆä¸­è‹±æ–‡ï¼‰

### ğŸ¤– AI ä»£ç†é›†æˆ

- æ¶ˆæ¯è‡ªåŠ¨è·¯ç”±åˆ°åˆé€‚çš„ AI ä»£ç†ï¼ˆç°ç°/æ—¶å·§/æŠ˜è¡·ï¼‰
- æ”¯æŒæµå¼å“åº”ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- æ”¯æŒç¬”è®°æŸ¥è¯¢ã€æ—¥ç¨‹ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½

---

## æŠ€æœ¯å˜æ›´

### æ–°å¢æ•°æ®åº“è¡¨

```sql
CREATE TABLE chat_app_credential (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES "user"(id) ON DELETE CASCADE,
  platform TEXT NOT NULL,
  platform_user_id TEXT NOT NULL,
  platform_chat_id TEXT,
  access_token TEXT,
  app_secret TEXT,
  webhook_url TEXT,
  enabled BOOLEAN DEFAULT true,
  created_ts BIGINT NOT NULL,
  updated_ts BIGINT NOT NULL,
  UNIQUE(user_id, platform)
);
```

### æ–°å¢ API æœåŠ¡

| RPC æ–¹æ³• | æè¿° |
|:---------|:-----|
| `RegisterCredential` | æ³¨å†ŒèŠå¤©åº”ç”¨å‡­è¯ |
| `ListCredentials` | åˆ—å‡ºç”¨æˆ·çš„å‡­è¯ |
| `DeleteCredential` | åˆ é™¤å‡­è¯ |
| `HandleWebhook` | å¤„ç†å¹³å° Webhook |
| `SendMessage` | å‘é€æ¶ˆæ¯åˆ°èŠå¤©å¹³å° |
| `GetWebhookInfo` | è·å– Webhook é…ç½®ä¿¡æ¯ |

### æ–°å¢ç›®å½•

```
plugin/chat_apps/
â”œâ”€â”€ channels/
â”‚   â”œâ”€â”€ base.go           # ChatChannel æ¥å£
â”‚   â”œâ”€â”€ router.go         # é€šé“è·¯ç”±å™¨
â”‚   â”œâ”€â”€ telegram/         # Telegram Bot å®ç°
â”‚   â”œâ”€â”€ whatsapp/         # WhatsApp æ¡¥æ¥
â”‚   â””â”€â”€ dingtalk/         # é’‰é’‰æœºå™¨äºº
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ db.go              # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ crypto.go          # Token åŠ å¯†
â”œâ”€â”€ metrics/
â”‚   â””â”€â”€ metrics.go         # æŒ‡æ ‡æ”¶é›†
â””â”€â”€ types.go               # ç±»å‹å®šä¹‰
```

### ç¯å¢ƒå˜é‡

| å˜é‡ | å¿…é¡» | è¯´æ˜ |
|:-----|:----:|:-----|
| `DIVINESENSE_CHAT_APPS_SECRET_KEY` | âœ… | 32å­—èŠ‚åŠ å¯†å¯†é’¥ |
| `DIVINESENSE_INSTANCE_URL` | âœ… | å®ä¾‹ URLï¼ˆç”Ÿæˆ Webhookï¼‰ |
| `DIVINESENSE_WHATSAPP_BRIDGE_URL` | âŒ | WhatsApp æ¡¥æ¥æœåŠ¡åœ°å€ |

---

## å‡çº§æŒ‡å—

### ä» v0.90.0 å‡çº§

1. **å¤‡ä»½ç°æœ‰æ•°æ®**ï¼š
   ```bash
   make db-backup
   ```

2. **æ‹‰å–æœ€æ–°ä»£ç **ï¼š
   ```bash
   git fetch origin
   git checkout v0.91.0
   ```

3. **è¿è¡Œæ•°æ®åº“è¿ç§»**ï¼š
   ```bash
   make db-upgrade
   ```

4. **é…ç½®ç¯å¢ƒå˜é‡**ï¼š
   ```bash
   # ç”Ÿæˆ 32 å­—èŠ‚åŠ å¯†å¯†é’¥
   openssl rand -base64 32 | head -c 32 > .chat_apps_secret_key

   # è®¾ç½®ç¯å¢ƒå˜é‡
   export DIVINESENSE_CHAT_APPS_SECRET_KEY=$(cat .chat_apps_secret_key)
   export DIVINESENSE_INSTANCE_URL=https://your-domain.com
   ```

5. **é‡æ–°æ„å»ºå¹¶å¯åŠ¨**ï¼š
   ```bash
   make build-all
   make start
   ```

### Docker éƒ¨ç½²

```bash
docker pull hrygo/divinesense:v0.91.0
docker stop divinesense
docker rm divinesense

docker run -d --name divinesense \
  -p 5230:5230 \
  -v ~/.divinesense:/var/opt/divinesense \
  -e DIVINESENSE_CHAT_APPS_SECRET_KEY=<your-key> \
  -e DIVINESENSE_INSTANCE_URL=https://your-domain.com \
  hrygo/divinesense:v0.91.0
```

---

## é…ç½®æŒ‡å—

### Telegram Bot é…ç½®

1. ä¸ [@BotFather](https://t.me/BotFather) å¯¹è¯ï¼Œåˆ›å»ºæ–° Bot
2. è·å– Bot Token
3. åœ¨ DivineSense è®¾ç½®é¡µé¢æ·»åŠ  Telegram è´¦å·
4. è®¾ç½® Webhook

**è¯¦ç»†æŒ‡å—**ï¼š[Telegram é…ç½®æŒ‡å—](../user-guides/CHAT_APPS.md#telegram-é…ç½®æŒ‡å—)

### é’‰é’‰æœºå™¨äººé…ç½®

1. ç™»å½• [é’‰é’‰å¼€æ”¾å¹³å°](https://open.dingtalk.com/)
2. åˆ›å»ºä¼ä¸šå†…éƒ¨åº”ç”¨ï¼Œè·å– AppKey å’Œ AppSecret
3. é…ç½®æ¶ˆæ¯æ¨é€åœ°å€
4. åœ¨ DivineSense è®¾ç½®é¡µé¢æ·»åŠ é’‰é’‰è´¦å·

**è¯¦ç»†æŒ‡å—**ï¼š[é’‰é’‰é…ç½®æŒ‡å—](../user-guides/CHAT_APPS.md#é’‰é’‰é…ç½®æŒ‡å—)

### WhatsApp é…ç½®ï¼ˆå¯é€‰ï¼‰

WhatsApp éœ€è¦è¿è¡Œé¢å¤–çš„ Node.js æ¡¥æ¥æœåŠ¡ï¼š

```bash
cd plugin/chat_apps/channels/whatsapp/bridge
npm install
npm start
```

**è¯¦ç»†æŒ‡å—**ï¼š[WhatsApp é…ç½®æŒ‡å—](../user-guides/CHAT_APPS.md#whatsapp-é…ç½®æŒ‡å—)

---

## å·²çŸ¥é—®é¢˜

| é—®é¢˜ | å½±å“ | è§£å†³æ–¹æ¡ˆ |
|:-----|:----:|:---------|
| é’‰é’‰åª’ä½“ä¸Šä¼  | ä¸æ”¯æŒå›¾ç‰‡/æ–‡ä»¶è‡ªåŠ¨å‘é€ | ä»¥æ–‡æœ¬å½¢å¼æç¤º |
| WhatsApp æ¡¥æ¥æœåŠ¡ | éœ€è¦ç‹¬ç«‹éƒ¨ç½² | ä½¿ç”¨ PM2 æˆ– systemd ç®¡ç† |
| SQLite æ•°æ®åº“ | ä¸æ”¯æŒ Chat Apps åŠŸèƒ½ | ä½¿ç”¨ PostgreSQL |

---

## æ–‡æ¡£æ›´æ–°

- [x] [ç”¨æˆ·æŒ‡å—](../user-guides/CHAT_APPS.md)
- [x] [æ¶æ„æ–‡æ¡£](../dev-guides/ARCHITECTURE.md)
- [x] [åç«¯å¼€å‘æŒ‡å—](../dev-guides/BACKEND_DB.md)
- [x] [å‰ç«¯å¼€å‘æŒ‡å—](../dev-guides/FRONTEND.md)
- [x] [æŠ€æœ¯è§„æ ¼](../archived/specs/20260207_archive/chat-apps-integration.md)

---

## è´¡çŒ®è€…

- [@hrygo](https://github.com/hrygo) - æ¶æ„è®¾è®¡ä¸å®ç°
- [Claude Opus 4.5](https://github.com/anthropics) - ä»£ç å®¡æŸ¥ä¸å®‰å…¨åŠ å›º

---

## è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](../../LICENSE)

---

**ä¸‹è½½åœ°å€**ï¼š
- Docker Hub: `hrygo/divinesense:v0.91.0`
- GitHub Release: [v0.91.0](https://github.com/hrygo/divinesense/releases/tag/v0.91.0)
