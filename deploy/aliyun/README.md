# DivineSense å•æœºéƒ¨ç½²æŒ‡å— (2C2G)

é€‚ç”¨äºé˜¿é‡Œäº‘/è…¾è®¯äº‘ 2æ ¸2G æœåŠ¡å™¨çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆã€‚

---

## ä¸€é”®å®‰è£…

```bash
curl -fsSL https://raw.githubusercontent.com/hrygo/divinesense/main/deploy/aliyun/install.sh | bash
```

**è‡ªåŠ¨å®Œæˆï¼š**
- âœ… å®‰è£… Docker + Docker Compose
- âœ… é…ç½®å›½å†…é•œåƒåŠ é€Ÿ
- âœ… ä¸‹è½½ DivineSense é•œåƒ
- âœ… ç”Ÿæˆå®‰å…¨å¯†ç 
- âœ… åˆå§‹åŒ– PostgreSQL + pgvector
- âœ… å¯åŠ¨æœåŠ¡
- âœ… é…ç½®é˜²ç«å¢™
- âœ… è®¾ç½®æ¯æ—¥è‡ªåŠ¨å¤‡ä»½

**å®‰è£…å®Œæˆåï¼š**

1. é…ç½® AI API Keysï¼š
```bash
vi /opt/divinesense/.env.prod

# ä¿®æ”¹ä»¥ä¸‹ä¸¤é¡¹ï¼š
DIVINESENSE_AI_SILICONFLOW_API_KEY=sk-xxx
DIVINESENSE_AI_DEEPSEEK_API_KEY=sk-xxx

# é‡å¯æœåŠ¡
cd /opt/divinesense && ./deploy.sh restart
```

2. è®¿é—®æœåŠ¡ï¼š`http://your-server-ip:5230`

---

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              2C2G æœåŠ¡å™¨                         â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           Docker Network                 â”‚  â”‚
â”‚  â”‚                                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  PostgreSQL  â”‚  â”‚   DivineSense   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  pg16+vector â”‚  â”‚   0.75æ ¸/800M  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ 0.75æ ¸/400M  â”‚â”€â”€â”‚  :5230 â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”¼â”€â”€â–º å…¬ç½‘
â”‚  â”‚  â”‚  :5432       â”‚  â”‚                 â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                 â”‚
â”‚  æ•°æ®å·: postgres_data, divinesense_data        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**èµ„æºåˆ†é… (2C2G ä¼˜åŒ–)**

| æœåŠ¡        | CPU    | å†…å­˜ | è¯´æ˜        |
| ----------- | ------ | ---- | ----------- |
| PostgreSQL  | 0.75æ ¸ | 400M | æ•°æ®åº“      |
| DivineSense | 0.75æ ¸ | 800M | åº”ç”¨æœåŠ¡    |
| ç³»ç»Ÿé¢„ç•™    | 0.5æ ¸  | 512M | OS + Docker |

---

## AI é…ç½®

DivineSense éœ€è¦ 2 ä¸ª API Keyï¼ˆå›½å†…æ¨èï¼‰ï¼š

| API Key     | ç”¨é€”               | è·å–åœ°å€                      |
| ----------- | ------------------ | ----------------------------- |
| SiliconFlow | å‘é‡/é‡æ’/æ„å›¾åˆ†ç±» | https://cloud.siliconflow.cn  |
| DeepSeek    | å¯¹è¯ LLM           | https://platform.deepseek.com |

**å…¶ä»–æ–¹æ¡ˆï¼š**
- çº¯ SiliconFlowï¼ˆå•ä¸€ä¾›åº”å•†ï¼‰
- OpenAIï¼ˆæµ·å¤–ç”¨æˆ·ï¼‰
- Ollamaï¼ˆæœ¬åœ°ç¦»çº¿ï¼‰

è¯¦è§ `.env.prod` æ–‡ä»¶å†…æ³¨é‡Šã€‚

### ğŸ¤“ Geek Mode (Claude Code) é…ç½®

**Geek Mode** æ˜¯ä¸€é¡¹ä¾›å¼€å‘è€…ä½¿ç”¨çš„é«˜çº§åŠŸèƒ½ï¼Œå…è®¸ Agent é€šè¿‡ `Claude Code CLI` ç›´æ¥æ“ä½œæœåŠ¡å™¨ç¯å¢ƒã€‚
å‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œ**é»˜è®¤å®‰è£…è„šæœ¬ä¸ä¼šå¯ç”¨è¯¥åŠŸèƒ½**ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®ã€‚

**å‰ç½®æ¡ä»¶ï¼š**
1. è·å– API Key: [æ™ºè°±å¼€æ”¾å¹³å°](https://bigmodel.cn/usercenter/proj-mgmt/apikeys) (æ¨è) æˆ– Anthropic å®˜æ–¹ Keyã€‚
2. ç¡®ä¿æœåŠ¡å™¨å·²å®‰è£… `Node.js 18+` ç¯å¢ƒã€‚

**é…ç½®æŒ‡å—ï¼š**

#### ğŸ…°ï¸ äºŒè¿›åˆ¶éƒ¨ç½² (æ¨è)
ç›´æ¥åœ¨æœåŠ¡å™¨ç»ˆç«¯æ‰§è¡Œï¼š

1. **å®‰è£…å·¥å…·**:
   ```bash
   npm install -g @anthropic-ai/claude-code
   ```
2. **è‡ªåŠ¨é…ç½®**:
   ```bash
   npx @z_ai/coding-helper
   ```

#### ğŸ…±ï¸ Docker éƒ¨ç½²
éœ€è¦è¿›å…¥å®¹å™¨å†…éƒ¨æ‰§è¡Œå®‰è£…ï¼ˆæ•°æ®å·æŒä¹…åŒ–ï¼‰ï¼š

1. **å®‰è£…å·¥å…· (éœ€ Root æƒé™)**:
   ```bash
   #è¿™æ˜¯åœ¨å®¹å™¨å†…å®‰è£…ï¼Œæ— éœ€æ‹…å¿ƒæ±¡æŸ“å®¿ä¸»æœº
   docker exec -u 0 -it divinesense npm install -g @anthropic-ai/claude-code
   ```
2. **è‡ªåŠ¨é…ç½®**:
   ```bash
   docker exec -it divinesense npx @z_ai/coding-helper
   ```

3. **å¯ç”¨åŠŸèƒ½**:
   ä¿®æ”¹ `/opt/divinesense/.env.prod` æ–‡ä»¶ï¼š
   ```bash
   # å¯ç”¨åŠŸèƒ½
   DIVINESENSE_CLAUDE_CODE_ENABLED=true
   ```

4. **é‡å¯æœåŠ¡**:
   ```bash
   cd /opt/divinesense && ./deploy.sh restart
   ```

---

## è¿ç»´å‘½ä»¤

```bash
cd /opt/divinesense

./deploy.sh status     # æŸ¥çœ‹çŠ¶æ€
./deploy.sh logs       # æŸ¥çœ‹æ—¥å¿—
./deploy.sh restart    # é‡å¯æœåŠ¡
./deploy.sh stop       # åœæ­¢æœåŠ¡
./deploy.sh backup     # æ‰‹åŠ¨å¤‡ä»½
./deploy.sh upgrade    # å‡çº§ç‰ˆæœ¬
```

---

## å¤‡ä»½

**è‡ªåŠ¨å¤‡ä»½ï¼š** æ¯å¤©å‡Œæ™¨ 2 ç‚¹ï¼ˆå®‰è£…æ—¶å·²é…ç½®ï¼‰

**æ‰‹åŠ¨å¤‡ä»½ï¼š**
```bash
cd /opt/divinesense && ./deploy.sh backup
```

**æ¢å¤å¤‡ä»½ï¼š**
```bash
cd /opt/divinesense && ./deploy.sh restore backups/divinesense-backup-xxx.gz
```

---

## å¸¸è§é—®é¢˜

| é—®é¢˜           | è§£å†³æ–¹æ¡ˆ                            |
| -------------- | ----------------------------------- |
| é•œåƒæ‹‰å–æ…¢     | ä¸€é”®å®‰è£…è„šæœ¬å·²è‡ªåŠ¨é…ç½®å›½å†…é•œåƒæº    |
| æœåŠ¡æ— æ³•å¯åŠ¨   | `./deploy.sh logs` æŸ¥çœ‹æ—¥å¿—         |
| å¿˜è®°æ•°æ®åº“å¯†ç  | `cat /opt/divinesense/.db_password` |
| é˜²ç«å¢™é—®é¢˜     | ç¡®ä¿å¼€æ”¾ 5230 ç«¯å£                  |

---

## å®‰å…¨å»ºè®®

1. **ä¿®æ”¹å¯†ç ** - å®‰è£…åä¿®æ”¹æ•°æ®åº“å¯†ç 
2. **å¤‡ä»½** - å·²é…ç½®æ¯æ—¥è‡ªåŠ¨å¤‡ä»½ï¼Œå»ºè®®å®šæœŸä¸‹è½½åˆ°æœ¬åœ°
3. **é˜²ç«å¢™** - åªå¼€æ”¾å¿…è¦ç«¯å£ (22, 80, 443, 5230)
4. **HTTPS** - ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®åå‘ä»£ç† + SSL

---

## æ–‡ä»¶ä½ç½®

```
/opt/divinesense/
â”œâ”€â”€ .env.prod          # ç¯å¢ƒé…ç½®
â”œâ”€â”€ .db_password       # æ•°æ®åº“å¯†ç 
â”œâ”€â”€ deploy.sh          # è¿ç»´è„šæœ¬
â””â”€â”€ backups/           # å¤‡ä»½ç›®å½•
```
