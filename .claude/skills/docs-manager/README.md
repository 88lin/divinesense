# docs-manager

> 项目文档管理技能 - 引用完整性 + 文档保鲜

## 📁 目录结构

```
docs-manager/
├── SKILL.md              # 主入口 (Claude Code 加载)
├── REFERENCE.md          # 详细参考与示例
├── README.md             # 本说明文件
├── scripts/              # 辅助脚本 (已弃用)
│   └── docs_helper.py
├── tests/                # 测试文件
│   └── docs_helper_test.py
└── templates/            # 模板目录
    └── README.md
```

## 🎯 核心功能

| 命令                       | 功能                     |
| :------------------------- | :----------------------- |
| `/docs-check`              | 检查文档健康状态         |
| `/docs-ref <file>`         | 查看文档引用关系         |
| `/docs-archive <files>`    | 归档文档并更新引用       |
| `/docs-new <type> <name>`  | 创建符合规范的新文档     |
| `/docs-sync [scope]`       | **文档保鲜** - 对比文档与实现 |

## 🔄 v6.0 核心改进

| 特性              | v5.1  | v6.0                    |
| :---------------- | :---- | :---------------------- |
| **状态机**        | 6 状态 | ✅ 11 状态流转           |
| **文档保鲜**      | 无    | ✅ 代码 vs 文档对比      |
| **深度分析**      | 无    | ✅ Task + code-explorer |
| **状态标记**      | 无    | ✅ 保鲜时间戳           |

## 📖 设计理念

```
                    /docs-sync
                         │
                         ▼
SCAN ──▶ ANALYZE ──▶ COMPARE ──▶ REPORT ──▶ UPDATE
  │           │           │           │          │
  └───────────┴───────────┴───────────┴──────────┘
              状态机驱动 + 元认知
```

- **目标导向**: 描述做什么，而非怎么做
- **动态发现**: 每次扫描目录结构，不硬编码路径
- **元认知**: 执行前自检，执行后验证
- **文档保鲜**: 对比文档描述与实际代码实现

## 🆕 文档保鲜功能

`/docs-sync` 命令会：

1. **扫描文档** - 识别需要检查的文档
2. **分析代码** - 使用 code-explorer agent 深度分析实现
3. **对比差异** - 生成文档 vs 实现的差异报告
4. **更新标记** - 在文档中添加保鲜状态标记

### 保鲜标记格式

```markdown
## 功能描述

> **保鲜状态**: ✅ 已验证 (YYYY-MM-DD)
> **覆盖范围**: `path/to/code.go`
> **最后检查**: vX.Y.Z
```

**获取项目版本** (执行时动态获取):
```bash
# 从 CHANGELOG.md 提取最新版本
grep "^## \[v" CHANGELOG.md | head -1 | sed 's/.*\[v//;s/\].*//'

# 或从 README.md 提取
grep "version-v" README.md | head -1 | sed 's/.*version-v//;s/"//'
```

## 📚 相关文档

| 文档                           | 说明               |
| :----------------------------- | :----------------- |
| [SKILL.md](./SKILL.md)         | 主技能定义         |
| [REFERENCE.md](./REFERENCE.md) | 详细参考与使用示例 |

---

> **Skill 版本**: v6.0 | **新增**: 文档保鲜 | **设计哲学**: 状态机驱动 + 元认知自检
>
> **注意**: Skill 版本与项目版本独立。文档保鲜标记应使用动态获取的项目版本。
