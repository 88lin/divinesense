import{r as e,j as s,aS as r,aW as o,cl as t,aY as a,cm as n,n as l,cn as i,aZ as d}from"./react-vendor-LyyF-653.js";import{l as c,L as m}from"./leaflet-vendor-Cu4zZue4.js";import{bp as u,S as x,g as p,n as f,bq as h,br as j,t as b}from"./index-D99LTaa7.js";import"./ui-vendor-ByoYm48K.js";import"./markdown-vendor-DtAGkuPo.js";import"./math-vendor-JUchi9-2.js";import"./mermaid-vendor-B1M2OtO5.js";import"./lodash-vendor-DIRPa7cU.js";import"./polyfills-RlNY0w59.js";import"./i18n-vendor-Cyfgqt0p.js";const g=e=>new c.DivIcon({html:`<span class="flex items-center justify-center w-full h-full bg-primary text-primary-foreground text-xs font-bold rounded-full shadow-md border-2 border-background">${e.getChildCount()}</span>`,className:"custom-marker-cluster",iconSize:m.point(32,32,!0)}),v=({memos:s})=>{const r=d();return e.useEffect(()=>{if(0===s.length)return;const e=s.filter(e=>e.location);if(0===e.length)return;const o=m.latLngBounds(e.map(e=>[e.location.latitude,e.location.longitude]));r.fitBounds(o,{padding:[50,50]})},[s,r]),null},N=({creator:d,className:c})=>{const m=e.useMemo(()=>(e=>{const s=e.match(/users\/(\d+)/);return s?s[1]:""})(d),[d]),{data:N,isLoading:y}=u({state:x.NORMAL,orderBy:"display_time desc",pageSize:1e3,filter:`creator_id == ${m}`}),w=e.useMemo(()=>N?.pages.flatMap(e=>e.memos).filter(e=>e.location)||[],[N]);if(y)return s.jsx("div",{className:"w-full h-[380px] flex items-center justify-center rounded-xl border border-border bg-muted/30",children:s.jsx(p,{className:"w-8 h-8"})});return s.jsxs("div",{className:f("relative z-0 w-full h-[380px] rounded-xl overflow-hidden border border-border shadow-sm",c),children:[0===w.length&&s.jsx("div",{className:"absolute inset-0 z-[1000] flex items-center justify-center pointer-events-none",children:s.jsxs("div",{className:"flex flex-col items-center gap-1 rounded-2xl border border-border bg-background/70 px-4 py-2 shadow-sm backdrop-blur-sm",children:[s.jsx(r,{className:"h-5 w-5 text-muted-foreground opacity-60"}),s.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"No location data found"})]})}),s.jsxs(o,{center:{lat:48.8566,lng:2.3522},zoom:2,className:"h-full w-full z-0",scrollWheelZoom:!0,attributionControl:!1,children:[s.jsx(h,{}),s.jsx(t,{chunkedLoading:!0,iconCreateFunction:g,maxClusterRadius:40,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,children:w.map(e=>s.jsx(a,{position:[e.location.latitude,e.location.longitude],icon:j,children:s.jsx(n,{closeButton:!1,className:"w-48!",children:s.jsxs("div",{className:"flex flex-col p-0.5",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-border pb-1 mb-1",children:[s.jsx("span",{className:"text-[10px] font-medium text-muted-foreground",children:e.displayTime&&b(e.displayTime).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),s.jsxs(l,{to:`/m/${e.name.split("/").pop()}`,className:"flex items-center gap-0.5 text-[10px] text-primary hover:opacity-80",children:["View",s.jsx(i,{className:"h-3 w-3"})]})]}),s.jsx("div",{className:"line-clamp-3 py-0.5 text-xs font-sans leading-snug text-foreground",children:e.snippet||"No content"})]})})},e.name))}),s.jsx(v,{memos:w})]})]})};export{N as default};
