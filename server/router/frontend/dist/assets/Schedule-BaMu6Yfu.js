var e=Object.defineProperty,s=(s,t,r)=>((s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r)(s,"symbol"!=typeof t?t+"":t,r);import{j as t,C as r,bo as a,X as n,cc as i,r as l,b as c,m as d,bU as o,aB as u,a5 as m,p as x,aS as h,ay as p,N as f,bJ as g,ah as b,aq as j,a4 as v,o as N,cd as y,c8 as w,$ as k,ce as D,cf as C,cg as T,ch as S,c7 as q,c2 as M}from"./react-vendor-LyyF-653.js";import{i as _,a8 as Y,a9 as E,ab as I,ac as $,G as A,t as K,q as z,b3 as H,b4 as F,b5 as L,b6 as B,b7 as O,b8 as P,a1 as U,T as R,af as W,n as Q,aa as G,b9 as Z,ba as J,bb as V,bc as X,bd as ee}from"./index-D99LTaa7.js";import{g as se}from"./mermaid-vendor-B1M2OtO5.js";import{i as te}from"./i18n-vendor-Cyfgqt0p.js";import{v as re,G as ae,a as ne}from"./GenerativeUIContainer-BFWocgGj.js";import"./ui-vendor-ByoYm48K.js";import"./leaflet-vendor-Cu4zZue4.js";import"./markdown-vendor-DtAGkuPo.js";import"./math-vendor-JUchi9-2.js";import"./lodash-vendor-DIRPa7cU.js";import"./polyfills-RlNY0w59.js";const ie=({open:e,onOpenChange:s,conflicts:l,onAdjust:c,onDiscard:d})=>{const o=_(),u=e=>{const s=K(z(H,{seconds:e,nanos:0}));return se(s).format("HH:mm")},m=e=>{const s=K(z(H,{seconds:e,nanos:0}));return se(s).format("YYYY-MM-DD")};return t.jsx(Y,{open:e,onOpenChange:s,children:t.jsxs(E,{size:"md",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"rounded-full bg-orange-100 dark:bg-orange-900/30 p-2.5",children:t.jsx(r,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx(I,{className:"text-lg",children:o("schedule.conflict-detected")}),t.jsx($,{className:"mt-1 text-sm",children:o("schedule.conflict-warning-desc",{count:l.length})})]})]}),t.jsx("div",{className:"mt-4 max-h-60 overflow-y-auto",children:t.jsx("div",{className:"space-y-2 p-1",children:l.map(e=>t.jsxs("div",{className:"flex items-start gap-3 rounded-lg border border-orange-200 dark:border-orange-800 bg-orange-50/50 dark:bg-orange-950/20 p-3",children:[t.jsx("div",{className:"mt-1",children:t.jsx(a,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})}),t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsx("p",{className:"font-medium text-sm text-foreground",children:e.title}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsxs("span",{className:"font-medium text-orange-700 dark:text-orange-300",children:[m(e.startTs)," ",u(e.startTs),e.endTs>0&&` - ${u(e.endTs)}`]}),e.location&&t.jsxs("span",{children:["â€¢ ",e.location]})]}),e.description&&t.jsx("p",{className:"line-clamp-2 text-xs text-muted-foreground",children:e.description})]})]},e.name))})}),t.jsxs("div",{className:"mt-6 flex flex-col gap-3 sm:flex-row sm:justify-end sm:space-x-2",children:[t.jsxs(A,{variant:"outline",onClick:d,className:"w-full sm:w-auto",children:[t.jsx(n,{className:"h-4 w-4 mr-2"}),o("schedule.cancel-create")]}),t.jsxs(A,{variant:"default",onClick:c,className:"w-full sm:w-auto cursor-pointer",children:[t.jsx(i,{className:"h-4 w-4 mr-2"}),o("schedule.modify-schedule")]})]}),t.jsx("p",{className:"mt-3 text-xs text-center text-muted-foreground",children:o("schedule.conflict-hint")})]})})};class le extends l.Component{constructor(){super(...arguments),s(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=te.t;return t.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[t.jsx("div",{className:"rounded-full bg-destructive/10 p-3",children:t.jsx(r,{className:"h-6 w-6 text-destructive"})}),t.jsx("h3",{className:"mt-4 text-lg font-semibold",children:e("schedule.error.something_went_wrong")}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:this.state.error?.message||e("schedule.error.loading_failed")}),t.jsx("button",{className:"mt-4 rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90",onClick:()=>this.setState({hasError:!1,error:null}),children:e("schedule.error.try_again")})]})}return this.props.children}}const ce=({open:e,onOpenChange:s,editSchedule:r,onSuccess:a})=>{const n=_(),i=c(),m=F(),x=L(),h=B(),p=O(),f=!!r,[g,b]=l.useState(null),[j,v]=l.useState([]),[N,y]=l.useState(!1),[w,k]=l.useState(!1);l.useEffect(()=>{if(e){if(r)b({...r});else{const e=se(),s=e.add(10-e.minute()%10+10,"minute").startOf("minute"),t=s.add(1,"hour");b(z(P,{title:"",startTs:BigInt(s.unix()),endTs:BigInt(t.unix()),location:"",description:"",reminders:[],name:""}))}v([]),y(!1)}},[e,r]);const D=async()=>{if(g)try{if(f&&g.name){const e=await x.mutateAsync({schedule:g,updateMask:["title","description","location","start_ts","end_ts","reminders"]});e&&(u.success(n("schedule.schedule-updated")||"Schedule updated"),a?.(e),C())}else{const e=`schedules/${Date.now()}`,s={...g,name:e},t=await m.mutateAsync(s);t&&(u.success(n("schedule.schedule-created")),a?.(t),C())}}catch(e){if(!(!e||"object"!=typeof e||!("message"in e))&&e.message.includes("conflicts detected")){const s=e.message||"";u.error(s)}else u.error(n(f?"schedule.quick-input.failed-to-update":"schedule.quick-input.failed-to-create"))}},C=()=>{b(null),v([]),y(!1),s(!1)};return t.jsxs(t.Fragment,{children:[t.jsx(Y,{open:e,onOpenChange:s,children:t.jsx(le,{children:t.jsxs(E,{size:"sm",className:"overflow-hidden min-w-[360px]",children:[t.jsx(I,{className:"text-lg font-semibold",children:n(f?"schedule.edit-schedule":"schedule.create-schedule")}),t.jsx($,{className:"hidden",children:"Schedule Form"}),t.jsx("div",{className:"space-y-4 pt-4",children:g&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(U,{className:"text-xs text-muted-foreground",children:n("common.title")}),t.jsx(R,{value:g.title,onChange:e=>b({...g,title:e.target.value}),className:"font-medium",placeholder:n("common.title"),autoFocus:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(U,{className:"text-xs text-muted-foreground",children:n("schedule.start-time")}),t.jsx(R,{type:"datetime-local",value:se(K(z(H,{seconds:g.startTs,nanos:0}))).format("YYYY-MM-DDTHH:mm"),onChange:e=>{const s=e.target.value;s&&b({...g,startTs:BigInt(se(s).unix())})},className:"bg-muted/30"})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(U,{className:"text-xs text-muted-foreground",children:n("schedule.end-time")}),t.jsx(R,{type:"datetime-local",value:se(K(z(H,{seconds:g.endTs,nanos:0}))).format("YYYY-MM-DDTHH:mm"),onChange:e=>{const s=e.target.value;s&&b({...g,endTs:BigInt(se(s).unix())})},className:"bg-muted/30"})]})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(U,{className:"text-xs text-muted-foreground",children:n("common.location")}),t.jsx(R,{value:g.location||"",onChange:e=>b({...g,location:e.target.value}),placeholder:n("common.location")})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(U,{className:"text-xs text-muted-foreground",children:n("common.description")}),t.jsx(W,{value:g.description||"",onChange:e=>b({...g,description:e.target.value}),className:"min-h-[80px] text-sm resize-none bg-muted/30",placeholder:n("common.description")})]}),t.jsxs("div",{className:Q("flex justify-between gap-3 pt-4 border-t",f?"":"justify-end"),children:[f&&t.jsxs(A,{variant:"ghost",onClick:()=>k(!0),className:"text-destructive hover:bg-destructive/10 px-2",children:[t.jsx(d,{className:"h-4 w-4 mr-2"}),n("common.delete")]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(A,{variant:"outline",onClick:C,children:n("common.cancel")}),t.jsx(A,{onClick:async()=>{if(g)if(g.title?.trim())try{const e=await p.mutateAsync({startTs:g.startTs,endTs:g.endTs,excludeNames:f&&g.name?[g.name]:[]});if(e.conflicts.length>0)return v(e.conflicts),void y(!0);await D()}catch(e){await D()}else u.error(n("message.fill-all-required-fields")||"Please fill all required fields")},className:"min-w-[80px]",children:n(f?"common.save":"common.create")})]})]})]})})]})})}),t.jsx(ie,{open:N,onOpenChange:y,conflicts:j,onAdjust:()=>y(!1),onDiscard:()=>C()}),t.jsx(Y,{open:w,onOpenChange:k,children:t.jsxs(E,{size:"sm",children:[t.jsxs(G,{children:[t.jsxs(I,{className:"flex items-center gap-2 text-destructive",children:[t.jsx(o,{className:"h-5 w-5"}),n("schedule.delete-schedule")]}),t.jsx($,{children:n("schedule.delete-confirm")})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[t.jsx(A,{variant:"outline",onClick:()=>k(!1),children:n("common.cancel")}),t.jsx(A,{variant:"destructive",onClick:async()=>{if(g?.name)try{await h.mutateAsync(g.name),u.success(n("schedule.schedule-deleted")),i.invalidateQueries({queryKey:["schedules"]}),C()}catch(e){u.error(n("schedule.parse-error")||"Failed to delete schedule")}finally{k(!1)}},children:n("common.delete")})]})]})})]})},de=({currentDate:e,selectedDate:s,schedules:r,onDateSelect:a,onPrevWeek:n,onNextWeek:i})=>{const l=se().format("YYYY-MM-DD"),c=e.subtract(3,"day");return t.jsxs("div",{className:"flex items-center justify-between px-2 sm:px-4 py-2 w-full bg-background/50 backdrop-blur-sm",children:[t.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 rounded-full text-muted-foreground/70 hover:text-foreground",onClick:n,children:t.jsx(p,{className:"h-4 w-4"})}),t.jsx("div",{className:"flex items-center justify-between flex-1 px-2 sm:px-6",children:Array.from({length:7},(e,n)=>{const i=c.add(n,"day"),d=i.format("YYYY-MM-DD"),o=d===l,u=d===s,m=r.filter(e=>{return(s=e.startTs,se(K(z(H,{seconds:s,nanos:0})))).format("YYYY-MM-DD")===d;var s}).length;return t.jsxs("button",{onClick:()=>a(i),className:Q("flex flex-col items-center justify-center w-11 h-16 rounded-2xl transition-all duration-200 relative group",u?"bg-primary text-primary-foreground shadow-lg shadow-primary/20 scale-105":o?"bg-primary/10 text-primary font-medium":"hover:bg-muted/80 text-muted-foreground"),children:[t.jsx("span",{className:Q("text-[11px] font-medium uppercase tracking-wider mb-0.5",u?"opacity-90":"opacity-60 group-hover:opacity-80"),children:i.format("ddd")}),t.jsx("span",{className:Q("text-xl font-semibold leading-none",(u||o)&&"font-bold"),children:i.format("D")}),t.jsxs("div",{className:"flex gap-0.5 h-1 mt-1.5",children:[m>0&&t.jsx("span",{className:Q("w-1 h-1 rounded-full",u?"bg-white/90":"bg-foreground/40")}),m>2&&t.jsx("span",{className:Q("w-1 h-1 rounded-full",u?"bg-white/90":"bg-foreground/40")})]})]},n)})}),t.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 rounded-full text-muted-foreground/70 hover:text-foreground",onClick:i,children:t.jsx(f,{className:"h-4 w-4"})})]})},oe=({schedules:e,selectedDate:s,onDateClick:r,onScheduleEdit:a,className:n=""})=>{const i=_(),[c,d]=l.useState(s?se(s):se()),o=l.useRef(null);l.useEffect(()=>{s&&d(se(s))},[s]);const u=c.format("YYYY-MM-DD"),p=u===se().format("YYYY-MM-DD"),f=e=>se(K(z(H,{seconds:e,nanos:0}))),g=l.useMemo(()=>e.filter(e=>f(e.startTs).format("YYYY-MM-DD")===u).sort((e,s)=>Number(e.startTs)-Number(s.startTs)),[e,u]),b=e=>{d(e),r?.(e.format("YYYY-MM-DD"))};return t.jsxs("div",{className:Q("flex flex-col h-full bg-background/50",n),children:[t.jsx("div",{className:"flex-none border-b bg-background/95 backdrop-blur z-20 sticky top-0 shadow-sm",children:t.jsx(de,{currentDate:c,selectedDate:u,schedules:e,onDateSelect:b,onPrevWeek:()=>b(c.subtract(1,"week")),onNextWeek:()=>b(c.add(1,"week"))})}),t.jsx("div",{ref:o,className:"flex-1 overflow-y-auto p-4 scroll-smooth",children:t.jsxs("div",{className:"max-w-3xl mx-auto min-h-full flex flex-col",children:[t.jsxs("div",{className:"mb-6 mt-2 flex items-baseline justify-between px-2",children:[t.jsxs("div",{className:"flex items-baseline gap-3",children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight text-foreground",children:p?i("common.today"):c.format("dddd")}),t.jsx("span",{className:"text-muted-foreground font-medium",children:c.format("MMMM D")})]}),t.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-muted text-muted-foreground",children:i("schedule.schedule-count",{count:g.length})})]}),0===g.length?t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-muted-foreground/40 pb-20 mt-10",children:[t.jsx(m,{className:"w-16 h-16 mb-4 opacity-20"}),t.jsx("p",{className:"text-lg font-medium",children:i("schedule.no-schedules")})]}):t.jsxs("div",{className:"relative flex flex-col gap-4 pb-20",children:[t.jsx("div",{className:"absolute left-[5rem] top-4 bottom-10 w-px bg-border/60"}),g.map(e=>{const s=f(e.startTs),r=f(e.endTs),n=r.isBefore(se()),l=s.isBefore(se())&&r.isAfter(se());return t.jsxs("div",{className:Q("flex gap-6 relative group transition-opacity",n&&"opacity-70"),children:[t.jsx("div",{className:"w-[4rem] flex-none text-right pt-2.5 flex flex-col items-end",children:t.jsx("span",{className:Q("text-sm font-bold tabular-nums",l?"text-primary":"text-foreground/90"),children:s.format("HH:mm")})}),t.jsx("div",{className:"absolute left-[5rem] -translate-x-1/2 pt-3.5 z-10 bg-background py-1",children:t.jsx("div",{className:Q("w-2.5 h-2.5 rounded-full border-2 transition-all",l?"bg-primary border-primary ring-4 ring-primary/10":"bg-background border-muted-foreground",n&&"bg-muted border-muted-foreground/30")})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx("div",{className:Q("relative w-full rounded-xl border transition-all duration-200 overflow-hidden","hover:shadow-md hover:border-primary/20",l?"bg-primary/5 border-primary/20":"bg-card border-border"),children:t.jsxs("div",{role:"button",onClick:()=>a?.(e),className:"p-3 sm:p-4 cursor-pointer",children:[t.jsx("div",{className:"flex justify-between items-start gap-4",children:t.jsxs("div",{className:"space-y-1.5 min-w-0",children:[t.jsx("h3",{className:Q("font-semibold text-base truncate leading-none",l&&"text-primary"),children:e.title||i("schedule.untitled")}),t.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-muted-foreground/80",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(x,{className:"w-3 h-3 shrink-0 opacity-70"}),t.jsxs("span",{children:[Math.max(15,r.diff(s,"minute"))," ",i("schedule.quick-input.minutes-abbr")]})]}),e.location&&t.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 max-w-[150px]",children:[t.jsx(h,{className:"w-3 h-3 shrink-0 opacity-70"}),t.jsx("span",{className:"truncate",children:e.location})]})]})]})}),e.description&&t.jsx("div",{className:"mt-2.5 pt-2.5 border-t border-border/40 text-xs text-muted-foreground/80 line-clamp-2 leading-relaxed",children:e.description})]})})})]},e.name)})]})]})})]})},ue={thinking:t.jsx(v,{className:"h-3.5 w-3.5"}),tool_use:t.jsx(w,{className:"h-3.5 w-3.5"}),tool_result:t.jsx(y,{className:"h-3.5 w-3.5"}),schedule_query:t.jsx(N,{className:"h-3.5 w-3.5"}),schedule_add:t.jsx(a,{className:"h-3.5 w-3.5"}),find_free_time:t.jsx(x,{className:"h-3.5 w-3.5"})};function me(e){const s=e.match(/^(\w+)(?::|$)/);return s?s[1]:null}function xe(e,s){switch(e.type){case"thinking":return e.data||s("schedule.ai.thinking");case"tool_use":{const t=me(e.data);return"schedule_query"===t?s("schedule.ai.checking-schedule"):"schedule_add"===t?s("schedule.ai.creating-schedule"):"find_free_time"===t?s("schedule.ai.finding-free-time"):"schedule_update"===t?s("schedule.ai.updating-schedule"):`${s("schedule.ai.using-tool")}: ${t}`}case"tool_result":return s("schedule.ai.tool-completed");case"answer":default:return e.data;case"error":return e.data||s("schedule.ai.error")}}function he(e){if("tool_use"===e.type){const s=me(e.data);if(s&&ue[s])return ue[s]}return ue[e.type]||t.jsx(v,{className:"h-3.5 w-3.5"})}function pe({events:e,isStreaming:s,className:r}){const a=_(),n=l.useRef(null),[i,c]=l.useState(!1);if(l.useEffect(()=>{n.current&&i&&(n.current.scrollTop=n.current.scrollHeight)},[e,i]),!s&&0===e.length)return null;const d=e[e.length-1],o=e.length>1;return i?t.jsxs("div",{ref:n,className:Q("rounded-lg border border-border/50 bg-muted/30 transition-all duration-200","max-h-[200px] overflow-y-auto",r),children:[t.jsxs("div",{className:"px-3 py-2 flex items-center justify-between border-b border-border/30",children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:a("schedule.ai.status-history")}),t.jsx("button",{type:"button",onClick:()=>c(!1),className:"text-xs text-muted-foreground hover:text-foreground flex items-center gap-1",children:t.jsx(j,{className:"h-3 w-3"})})]}),t.jsx("div",{className:"p-3 space-y-2",children:e.map((s,r)=>{const n=r===e.length-1,i=xe(s,a),l=he(s);return t.jsxs("div",{className:Q("flex items-start gap-2 text-sm",n?"text-foreground":"text-muted-foreground"),children:[t.jsx("div",{className:Q("flex-shrink-0 mt-0.5 p-1 rounded-md","tool_result"===s.type&&"text-green-600 dark:text-green-400 bg-green-500/10","tool_use"===s.type&&"text-blue-600 dark:text-blue-400 bg-blue-500/10","thinking"===s.type&&"text-primary bg-primary/10","error"===s.type&&"text-red-600 dark:text-red-400 bg-red-500/10"),children:l}),t.jsx("span",{className:Q("flex-1 leading-relaxed",n&&"font-medium"),children:i})]},`${s.type}-${r}`)})}),s&&t.jsx("div",{className:"h-0.5 bg-muted overflow-hidden",children:t.jsx("div",{className:"h-full bg-primary/60 w-full",style:{animation:"pulse 1.5s ease-in-out infinite"}})})]}):t.jsxs("div",{className:Q("rounded-lg border border-border/50 bg-muted/30 transition-all duration-200",r),children:[t.jsxs("div",{className:"px-3 py-2 flex items-center justify-between gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s?t.jsx(g,{className:"h-3.5 w-3.5 animate-spin text-primary flex-shrink-0"}):d?t.jsx("div",{className:Q("flex-shrink-0 p-1 rounded-md","tool_result"===d.type&&"text-green-600 dark:text-green-400 bg-green-500/10","error"===d.type&&"text-red-600 dark:text-red-400 bg-red-500/10","tool_result"!==d.type&&"error"!==d.type&&"text-primary bg-primary/10"),children:he(d)}):null,t.jsx("span",{className:"text-sm text-muted-foreground truncate",children:d?xe(d,a):a("schedule.ai.processing")})]}),o&&t.jsxs("button",{type:"button",onClick:()=>c(!0),className:"text-xs text-muted-foreground hover:text-foreground flex items-center gap-1 flex-shrink-0",children:[t.jsx("span",{children:e.length}),t.jsx(b,{className:"h-3 w-3"})]})]}),s&&t.jsx("div",{className:"h-0.5 bg-muted overflow-hidden",children:t.jsx("div",{className:"h-full bg-primary/60 w-full",style:{animation:"pulse 1.5s ease-in-out infinite"}})})]})}const fe=e=>{const s=document.createElement("div");s.setAttribute("role","status"),s.setAttribute("aria-live","polite"),s.className="sr-only",s.textContent=e,document.body.appendChild(s),setTimeout(()=>document.body.removeChild(s),1e3)};function ge(e,s,t,r,a,n,i,l){let c=n;e&&(c=e.includes("æ˜å¤©")?i:e.includes("ä»Šå¤©")?n:e);let d,o="09:00";s&&(o=be(s)),t&&(d=be(t));const u=r?.trim()||"";return{id:`${Date.now()}-${Math.random()}`,title:u||"",date:c,startTime:o,endTime:d,rawText:a}}function be(e){const s=e.match(/(\d{1,2})\s*(?:ç‚¹|æ—¶)/);if(s){let t=parseInt(s[1],10);(e.includes("ä¸‹åˆ")||e.includes("æ™šä¸Š"))&&t<12&&(t+=12),e.includes("ä¸Šåˆ")&&12===t&&(t=0);const r=e.includes("åŠ")?"30":"00";return`${t.toString().padStart(2,"0")}:${r}`}const t=e.match(/(\d{1,2}):(\d{2})\s*(AM|PM|am|pm)?/);if(t){let e=parseInt(t[1],10);const s=t[2],r=t[3]?.toUpperCase();return"PM"===r&&e<12&&(e+=12),"AM"===r&&12===e&&(e=0),`${e.toString().padStart(2,"0")}:${s}`}const r=e.match(/(\d{1,2})\s*(AM|PM|am|pm)/);if(r){let e=parseInt(r[1],10);const s=r[2].toUpperCase();return"PM"===s&&e<12&&(e+=12),"AM"===s&&12===e&&(e=0),`${e.toString().padStart(2,"0")}:00`}return"09:00"}function je({suggestions:e,onConfirmSuggestion:s,className:r}){const a=_(),[n,i]=l.useState(null),[c,d]=l.useState(0);if(0===e.length)return null;const o=e=>{const t=Date.now();if(t-c<300&&n===e.id)s(e),i(null),fe(a("schedule.quick-input.schedule-created"));else if(n===e.id)s(e),i(null),fe(a("schedule.quick-input.schedule-created"));else{i(e.id);const s=a("schedule.quick-input.default-title");fe(a("schedule.quick-input.selected-label").replace("{title}",e.title||s).replace("{date}",e.date).replace("{time}",e.startTime))}d(t)};return t.jsxs("div",{className:Q("w-full",r),children:[t.jsxs("div",{className:"flex items-center gap-2 px-1 mb-2",children:[t.jsx("span",{className:"text-base",role:"img","aria-label":"é‡‘åˆšé¹¦é¹‰",children:"ğŸ¦œ"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:a("schedule.quick-input.ai-suggestions")})]}),t.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",role:"listbox","aria-label":a("schedule.quick-input.ai-suggestions"),children:e.map(e=>{const s=n===e.id,r=a("schedule.quick-input.default-title"),l=a("schedule.quick-input.create-schedule-label").replace("{title}",e.title||r).replace("{date}",e.date).replace("{time}",e.startTime).replace("{endTime}",e.endTime?` - ${e.endTime}`:"");return t.jsxs("button",{type:"button",role:"option","aria-selected":s,"aria-label":l,tabIndex:0,onClick:()=>o(e),onKeyDown:s=>((e,s)=>{"Enter"===e.key||" "===e.key?(e.preventDefault(),o(s)):"Escape"===e.key&&n&&(e.preventDefault(),i(null),fe(a("schedule.quick-input.selection-canceled")))})(s,e),className:Q("group flex-1 min-w-0 text-left relative","p-3 rounded-xl border-2 transition-all duration-200","active:scale-[0.98]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",!s&&"border-amber-500/20 bg-amber-50/50 dark:bg-amber-950/20 hover:border-amber-500/40 hover:bg-amber-50/80 dark:hover:bg-amber-950/30",s&&"border-amber-600 bg-amber-100 dark:bg-amber-900/50 ring-2 ring-amber-500/40 shadow-md"),children:[s&&t.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 rounded-full bg-amber-500 flex items-center justify-center animate-in zoom-in-50",children:t.jsx(k,{className:"w-3 h-3 text-white"})}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-xs shadow-sm",children:"ğŸ¦œ"}),t.jsx("span",{className:"text-[10px] text-amber-600 dark:text-amber-400 font-medium",children:"é‡‘åˆš"})]}),t.jsx("div",{className:Q("font-medium text-sm truncate mb-2 pr-6",!s&&"group-hover:text-amber-700 dark:group-hover:text-amber-300"),children:e.title||a("schedule.quick-input.default-title")}),t.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[t.jsx(D,{className:"w-3 h-3 flex-shrink-0"}),t.jsx("span",{children:e.date}),t.jsxs("span",{className:"font-medium text-foreground",children:[e.startTime,e.endTime&&` - ${e.endTime}`]})]}),t.jsx("div",{className:"mt-2 text-[10px]",children:s?t.jsx("span",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:a("schedule.quick-input.click-again-create")}):t.jsx("span",{className:"text-amber-600/80 hidden sm:inline",children:a("schedule.quick-input.double-click-create")})})]},e.id)})})]})}const ve=[{id:"meeting-15",title:"15åˆ†é’Ÿä¼šè®®",i18nKey:"schedule.quick-input.template-meeting-15",promptI18nKey:"schedule.quick-input.prompt-meeting-15",icon:"users",duration:15,defaultTitle:"å¿«é€Ÿä¼šè®®",color:"bg-blue-500"},{id:"meeting-30",title:"30åˆ†é’Ÿä¼šè®®",i18nKey:"schedule.quick-input.template-meeting-30",promptI18nKey:"schedule.quick-input.prompt-meeting-30",icon:"users",duration:30,defaultTitle:"ä¼šè®®",color:"bg-blue-500"},{id:"video-call",title:"è§†é¢‘ä¼šè®®",i18nKey:"schedule.quick-input.template-video",promptI18nKey:"schedule.quick-input.prompt-video",icon:"video",duration:45,defaultTitle:"è§†é¢‘ä¼šè®®",color:"bg-purple-500"},{id:"workout",title:"è¿åŠ¨",i18nKey:"schedule.quick-input.template-workout",promptI18nKey:"schedule.quick-input.prompt-workout",icon:"dumbbell",duration:60,defaultTitle:"é”»ç‚¼",color:"bg-red-500"},{id:"focus-60",title:"ä¸“æ³¨æ—¶é—´",i18nKey:"schedule.quick-input.template-focus",promptI18nKey:"schedule.quick-input.prompt-focus",icon:"focus",duration:60,defaultTitle:"ä¸“æ³¨æ—¶é—´",color:"bg-indigo-500"}],Ne={users:({className:e})=>t.jsxs("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"9",cy:"7",r:"4"}),t.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),t.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),video:T,dumbbell:C,focus:({className:e})=>t.jsxs("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("circle",{cx:"12",cy:"12",r:"6"}),t.jsx("circle",{cx:"12",cy:"12",r:"2"})]})};function ye({onSelect:e,className:s,open:r,onToggle:a,disabled:n=!1}){const i=_(),c=l.useRef(null),d=l.useRef(null),[o,u]=l.useState({});l.useEffect(()=>{if(!r||!c.current)return;const e=c.current.getBoundingClientRect();u({position:"fixed",left:`${e.left}px`,bottom:window.innerHeight-e.top+8+"px",width:"208px"})},[r]),l.useEffect(()=>{if(!r||!a)return;const e=e=>{"Escape"===e.key&&(e.preventDefault(),a(),c.current?.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[r,a]),function(e,s,t=!0){l.useEffect(()=>{if(!t)return;const r=t=>{e.current&&!e.current.contains(t.target)&&s()};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}},[e,s,t])}(d,()=>{r&&a?.()},r);const m=r?t.jsxs("div",{ref:d,style:o,className:"p-1.5 bg-popover rounded-lg border shadow-lg z-[9999] max-h-[60vh] overflow-y-auto",role:"menu","aria-label":i("schedule.quick-input.quick-create"),children:[t.jsx("div",{className:"text-[10px] text-muted-foreground mb-1.5 px-1",children:i("schedule.quick-input.quick-create")}),t.jsx("div",{className:"flex flex-col gap-0.5",role:"presentation",children:ve.map(s=>{const r=Ne[s.icon]||Ne.users,n=s.i18nKey&&i(s.i18nKey)||s.title;return t.jsxs("button",{type:"button",role:"menuitem",tabIndex:0,onClick:()=>{e?.(s),a?.()},className:Q("flex items-center gap-2 px-2 py-2 rounded-md text-xs min-h-[44px]","hover:bg-muted transition-colors","text-left w-full focus-visible:ring-2 focus-visible:ring-border focus-visible:ring-offset-1"),"aria-label":`${n}ï¼Œ${s.duration}åˆ†é’Ÿ`,children:[t.jsx("div",{className:Q("h-5 w-5 rounded flex items-center justify-center shrink-0",s.color,"text-white"),"aria-hidden":"true",children:t.jsx(r,{className:"h-3 w-3"})}),t.jsx("span",{className:"font-medium truncate flex-1",children:n}),t.jsxs("span",{className:"text-[10px] text-muted-foreground shrink-0",children:[s.duration,i("schedule.quick-input.minutes-abbr")]})]},s.id)})})]}):null;return t.jsxs("div",{className:Q("relative",s),children:[t.jsx("button",{ref:c,type:"button",onClick:a,disabled:n,"aria-expanded":r,"aria-haspopup":"menu","aria-label":i("schedule.quick-input.templates"),className:Q("flex items-center justify-center text-xs font-medium transition-all duration-200 focus-visible:ring-2 focus-visible:ring-border focus-visible:ring-offset-1","h-9 w-[52px] rounded-lg",n?"text-muted-foreground/40 cursor-not-allowed opacity-50":"text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:[t.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),t.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),t.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),t.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}),m&&S.createPortal(m,document.body)]})}const we=24;function ke({initialDate:e,onScheduleCreated:s,editingSchedule:r,onClearEditing:a,uiTools:i=[],onUIAction:c,onUIDismiss:d,onUIEvent:o,className:m}){const x=Z(),h=_(),[p,b]=l.useState(""),[j,N]=l.useState(we),[y,w]=l.useState(""),D=l.useRef(null),C=l.useRef(0),[T,S]=l.useState(!1),[M,Y]=l.useState(""),[E,I]=l.useState([]),[$,K]=l.useState(!1),[z,H]=l.useState([]),F=x.isStreaming,L=[...i,...z],B=l.useCallback(e=>{z.some(s=>s.id===e.toolId)&&H(s=>s.filter(s=>s.id!==e.toolId)),c?.(e)},[z,c]),O=l.useCallback(e=>{z.some(s=>s.id===e)&&H(s=>s.filter(s=>s.id!==e)),d?.(e)},[z,d]);l.useEffect(()=>{if(!D.current)return;const e=()=>{if(!D.current)return;D.current.style.height="auto";const e=Math.min(Math.max(D.current.scrollHeight,we),120);D.current.style.height=`${e}px`,N(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[p]),l.useEffect(()=>{if(0===x.uiEvents.length)return void H([]);const e=[];for(const s of x.uiEvents){if(!s.uiType||!s.uiData)continue;let t,r;switch(s.uiType){case"ui_schedule_suggestion":{const e=re(s.uiData,ne,"ui_schedule_suggestion");if(!e)continue;t="schedule_suggestion",r=e;break}case"ui_time_slot_picker":t="time_slot_picker",r=s.uiData;break;case"ui_conflict_resolution":t="conflict_resolution",r=s.uiData;break;case"ui_quick_actions":t="quick_actions",r=s.uiData;break;case"ui_memo_preview":t="memo_preview",r=s.uiData;break;case"ui_progress_tracker":t="progress_tracker",r=s.uiData;break;default:continue}const a="uitool-"+ ++C.current;e.push({id:a,type:t,data:r,timestamp:Date.now()}),o?.({type:s.type,data:s.data,uiType:s.uiType,uiData:s.uiData})}H(e)},[x.uiEvents,o]),l.useEffect(()=>{if($){const e=setTimeout(()=>K(!1),2e3);return()=>clearTimeout(e)}},[$]);const P=()=>{K(!0),u.success(h("schedule.schedule-created")||h("schedule.quick.input.schedule-created-fallback")),b(""),w(""),Y(""),I([]),H([]),D.current&&(D.current.style.height="24px",N(we)),s?.()},U=async()=>{const s=p.trim();if(!s||F)return;w(s),b(""),Y("");let t=s;if(r){const e=`${se.unix(Number(r.startTs)).format("HH:mm")}-${se.unix(Number(r.endTs)).format("HH:mm")}`;t=`æŠŠã€Œ${r.title}ã€ï¼ˆ${e}ï¼‰${s}`}e&&(t=`[æ—¥æœŸ: ${e}] ${t}`);try{const e=await x.startChat(t,Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Shanghai")||"";if(e.includes("å·²æˆåŠŸåˆ›å»º")||e.includes("æˆåŠŸåˆ›å»ºæ—¥ç¨‹")||e.includes("successfully created")||e.includes("å·²å®‰æ’")||e.includes("å·²ä¸ºæ‚¨åˆ›å»º")||e.includes("å·²æ›´æ–°")||e.includes("updated successfully")||e.includes("ä¿®æ”¹æˆåŠŸ"))P(),r&&a?.();else{Y(e);const s=h("schedule.quick-input.today"),t=function(e,s="ä»Šå¤©",t="æ˜å¤©"){if(!e)return[];const r=[],a=e.split("\n").filter(e=>e.trim()),n=[/(?:å»ºè®®åˆ›å»º|å¯ä»¥åˆ›å»º|ä¸ºæ‚¨åˆ›å»º|åˆ›å»º)\s*[:ï¼š]?\s*(ä»Šå¤©|æ˜å¤©)?(?:ä¸Šåˆ|ä¸‹åˆ|æ™šä¸Š)?(\d{1,2})(?:ç‚¹|æ—¶)(?:åŠ)?(?:\d{1,2}åˆ†?)?(?:åˆ°|-)?(?:\d{1,2})?(?:ç‚¹|æ—¶)?(?:åŠ)?çš„?(.+)/gi,/(ä»Šå¤©|æ˜å¤©|\d{1,2}æœˆ\d{1,2}æ—¥)\s*(\d{1,2}:\d{2}|\d{1,2}\s*(?:AM|PM|am|pm)?)\s*(?:åˆ°|-)\s*(\d{1,2}:\d{2}|\d{1,2}\s*(?:AM|PM|am|pm)?)?\s*çš„?(.+)/gi];for(const l of a)for(const e of n){e.lastIndex=0;const a=e.exec(l);if(a){const[,e,n,i,c]=a,d=ge(e,n,i,c,l,s,t);if(d){r.push(d);break}}}const i=/^\d+[.ã€]\s*(.+)/;for(const l of a){const e=l.match(i);if(e){const a=e[1];for(const e of n){e.lastIndex=0;const n=e.exec(a);if(n){const[,e,i,l,c]=n,d=ge(e,i,l,c,a,s,t);if(d&&!r.find(e=>e.rawText===a)){r.push(d);break}}}}}return r.slice(0,3)}(e,s,h("schedule.quick-input.tomorrow"));I(t)}}catch(n){u.error(h("schedule.parse-error")||h("schedule.quick.input.parse-error-fallback")),b(s)}},R=()=>{b(""),w(""),Y(""),I([]),K(!1),D.current&&(D.current.style.height="24px",N(we))},G=p;return t.jsxs("div",{className:Q("w-full flex flex-col gap-2",m),children:[L.length>0&&t.jsx(ae,{tools:L,onAction:B,onDismiss:O}),$&&!F&&0===L.length&&t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-gradient-to-r from-green-500/10 to-green-500/5 rounded-xl border border-green-500/20 animate-in slide-in-from-top-2",children:[t.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-green-500 flex items-center justify-center",children:t.jsx(k,{className:"h-5 w-5 text-white"})}),t.jsx("div",{children:t.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:h("schedule.quick.input.created-success")})})]}),F&&0===L.length&&t.jsxs(t.Fragment,{children:[0===x.events.length&&t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-gradient-to-r from-primary/10 to-primary/5 rounded-xl border border-primary/20 animate-pulse",children:[t.jsx(g,{className:"h-5 w-5 animate-spin text-primary"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-foreground",children:h("schedule.quick.input.creating")}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:['"',y,'"']})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("span",{className:"flex h-2 w-2 rounded-full bg-primary/40 animate-bounce [animation-delay:-0.3s]"}),t.jsx("span",{className:"flex h-2 w-2 rounded-full bg-primary/40 animate-bounce [animation-delay:-0.15s]"}),t.jsx("span",{className:"flex h-2 w-2 rounded-full bg-primary/40 animate-bounce"})]})]}),x.events.length>0&&t.jsx(pe,{events:x.events,isStreaming:F,className:"mb-2"})]}),M&&!F&&0===L.length&&t.jsxs("div",{className:"flex items-start gap-3 px-4 py-3 bg-muted/50 rounded-xl border border-border/50",children:[t.jsx(v,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-foreground/90",children:M}),E.length>0&&t.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(f,{className:"h-3 w-3"}),t.jsx("span",{children:h("schedule.quick.input.select-suggestion")})]})]})]}),E.length>0&&0===L.length&&t.jsx(je,{suggestions:E,onConfirmSuggestion:async e=>{const s=h("schedule.quick.input.suggestion-message",{date:e.date,title:e.title,startTime:e.startTime,endTime:e.endTime||""});try{const e=await x.startChat(s,Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Shanghai")||"";e.includes("å·²æˆåŠŸåˆ›å»º")||e.includes("å·²å®‰æ’")||e.includes("å·²ä¸ºæ‚¨åˆ›å»º")?P():Y(e)}catch(t){u.error(h("schedule.quick.input.create-failed"))}}}),t.jsxs("div",{className:Q("flex items-center gap-2 p-2.5 rounded-xl border-2 transition-all duration-300",F&&"border-primary/40 bg-primary/5",$&&"border-green-500/40 bg-green-500/5",!F&&!$&&"border-border bg-background"),children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ye,{open:T,onToggle:()=>S(!T),onSelect:e=>{const s=e.promptI18nKey?h(e.promptI18nKey)||e.prompt||e.title:e.prompt||e.title;b(s),D.current?.focus()},disabled:F})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(W,{ref:D,value:G,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),U()),"Escape"===e.key&&p&&(e.preventDefault(),R())},placeholder:h("schedule.quick.input.placeholder"),className:Q("min-h-[24px] max-h-[120px] py-2 px-3 resize-none","border-0 bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0","text-sm",F&&"opacity-70"),style:{height:`${j}px`},rows:1,disabled:F})}),t.jsx("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:F?t.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:t.jsx(g,{className:"h-4 w-4 animate-spin text-primary"})}):t.jsxs(t.Fragment,{children:[p.length>0&&t.jsx(A,{size:"sm",variant:"ghost",onClick:R,className:"h-8 w-8 rounded-full p-0",children:t.jsx(n,{className:"h-4 w-4"})}),t.jsx(A,{size:"sm",onClick:U,disabled:!p.trim(),className:Q("h-9 w-[52px] rounded-lg p-0 transition-all duration-200",p.trim()?"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm":"bg-transparent text-muted-foreground hover:bg-muted/50"),children:t.jsx(q,{className:"h-4 w-4"})})]})})]})]})}const De=()=>{const e=_(),s=c(),{selectedDate:r,setSelectedDate:n,filteredSchedules:i,hasSearchFilter:d,setFilteredSchedules:o,setHasSearchFilter:u}=J(),[m,x]=l.useState("timeline"),[h,p]=l.useState(!1),[f,g]=l.useState(null),[b,j]=l.useState([]),v=l.useMemo(()=>r?new Date(r+"T00:00:00"):new Date,[r]),{data:N}=V(v),y=N?.schedules||[],w=d?i:y,k=d?"timeline":m,D=()=>{p(!1),g(null)},C=e=>{n(e),x("timeline")};return t.jsxs("div",{className:"w-full max-w-[100rem] mx-auto h-full flex overflow-hidden",children:[t.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden w-full",children:[t.jsx("div",{className:"hidden lg:flex flex-none px-4 py-3 border-b border-border/50 overflow-hidden",children:t.jsxs("div",{className:"flex items-center justify-between gap-4 w-full",children:[d?t.jsxs("span",{className:"text-sm text-muted-foreground",children:[i.length," ",e("schedule.search-results")||"results"]}):t.jsxs("div",{className:"flex items-center gap-1.5 p-1 bg-muted/50 rounded-lg",role:"tablist",children:[t.jsxs(A,{role:"tab","aria-selected":"timeline"===m,variant:"timeline"===m?"default":"ghost",size:"sm",className:"h-9 px-3 text-sm font-medium rounded-md",onClick:()=>x("timeline"),children:[t.jsx(M,{className:"w-4 h-4 mr-1.5"}),e("schedule.timeline")||"Timeline"]}),t.jsxs(A,{role:"tab","aria-selected":"calendar"===m,variant:"calendar"===m?"default":"ghost",size:"sm",className:"h-9 px-3 text-sm font-medium rounded-md",onClick:()=>x("calendar"),children:[t.jsx(a,{className:"w-4 h-4 mr-1.5"}),e("schedule.month-view")||"Month"]})]}),t.jsx("div",{className:"flex items-center gap-2 justify-end",children:t.jsx(X,{schedules:y,onFilteredChange:o,onHasFilterChange:u,className:"w-80"})})]})}),t.jsx("div",{className:"lg:hidden flex-none px-3 py-2 flex items-center justify-between gap-2 border-b border-border/50",children:d?t.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.length," ",e("schedule.search-results")||"results"]}):t.jsxs("div",{className:"flex items-center gap-1 p-1 bg-muted/50 rounded-lg",children:[t.jsx(A,{"aria-selected":"timeline"===m,variant:"timeline"===m?"default":"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-md min-h-[44px] min-w-[44px]",onClick:()=>x("timeline"),children:t.jsx(M,{className:"w-4 h-4"})}),t.jsx(A,{"aria-selected":"calendar"===m,variant:"calendar"===m?"default":"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-md min-h-[44px] min-w-[44px]",onClick:()=>x("calendar"),children:t.jsx(a,{className:"w-4 h-4"})})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-4 overflow-x-hidden",children:"calendar"===k?t.jsx(ee,{schedules:w,selectedDate:r,onDateClick:C,showMobileHint:!1}):t.jsx(oe,{schedules:w,selectedDate:r,onDateClick:C,onScheduleEdit:e=>{g(e),p(!0)}})}),t.jsx("div",{className:"flex-none p-4 bg-background/95 backdrop-blur-sm border-t border-border/50",children:t.jsx(ke,{initialDate:r,onScheduleCreated:()=>{s.invalidateQueries({queryKey:["schedules"]})},uiTools:b,onUIAction:e=>{j(s=>s.filter(s=>s.id!==e.toolId)),s.invalidateQueries({queryKey:["schedules"]})},onUIDismiss:e=>{j(s=>s.filter(s=>s.id!==e))}})})]}),t.jsx(ce,{open:h,onOpenChange:D,editSchedule:f,contextDate:r,onSuccess:()=>{D(),s.invalidateQueries({queryKey:["schedules"]})}})]})};export{De as default};
