import{r as e,j as s,bU as a,L as t}from"./react-vendor-LyyF-653.js";import{i,d as r,u as n,e as l,Q as o,T as c,n as d,G as u,f as m,s as f,t as p}from"./index-D99LTaa7.js";function h(){const h=i(),x=r(),{profile:g}=n(),{initialize:v}=l(),w=o(!1),[j,b]=e.useState("demo"===g.mode?"demo":""),[y,N]=e.useState("demo"===g.mode?"secret":""),[k,C]=e.useState(""),L=async()=>{if(""!==j&&""!==y&&!w.isLoading){try{w.setLoading();const e=await m.signIn({credentials:{case:"passwordCredentials",value:{username:j,password:y}}});e.accessToken&&f(e.accessToken,e.accessTokenExpiresAt?p(e.accessTokenExpiresAt):void 0),await v(),x("/")}catch(e){const s=e instanceof Error?e.message:String(e);C(function(e,s){const a=e.toLowerCase();return a.includes("network")||a.includes("fetch")||a.includes("connect")?s("auth.error.network"):a.includes("401")||a.includes("unauthorized")||a.includes("invalid")||a.includes("credentials")?s("auth.error.invalid-credentials"):a.includes("not found")||a.includes("404")?s("auth.error.user-not-found"):a.includes("500")||a.includes("502")||a.includes("503")?s("auth.error.server"):a.includes("429")||a.includes("rate limit")||a.includes("too many")?s("auth.error.rate-limit"):s("auth.error.default")}(s,h))}w.setFinish()}};return s.jsxs("form",{className:"w-full mt-2",onSubmit:e=>{e.preventDefault(),L()},children:[s.jsxs("div",{className:"flex flex-col justify-start items-start w-full gap-4",children:[k&&s.jsxs("div",{className:"w-full flex items-center gap-2 p-3 text-sm text-destructive bg-destructive/10 border border-destructive/20 rounded-md animate-in fade-in slide-in-from-top-1",children:[s.jsx(a,{className:"w-4 h-4 shrink-0"}),s.jsx("span",{children:k})]}),s.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[s.jsx("span",{className:"leading-8 text-muted-foreground",children:h("common.username")}),s.jsx(c,{type:"text",readOnly:w.isLoading,placeholder:h("common.username"),value:j,autoComplete:"username",autoCapitalize:"off",spellCheck:!1,onChange:e=>{const s=e.target.value;b(s),k&&C("")},className:d("w-full bg-background h-10",k&&"border-destructive focus-visible:ring-destructive/50"),required:!0})]}),s.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[s.jsx("span",{className:"leading-8 text-muted-foreground",children:h("common.password")}),s.jsx(c,{type:"password",readOnly:w.isLoading,placeholder:h("common.password"),value:y,autoComplete:"current-password",autoCapitalize:"off",spellCheck:!1,onChange:e=>{const s=e.target.value;N(s),k&&C("")},className:d("w-full bg-background h-10",k&&"border-destructive focus-visible:ring-destructive/50"),required:!0})]})]}),s.jsx("div",{className:"flex flex-row justify-end items-center w-full mt-6",children:s.jsxs(u,{type:"submit",className:"w-full h-10",disabled:w.isLoading,onClick:L,children:[h("common.sign-in"),w.isLoading&&s.jsx(t,{className:"w-5 h-auto ml-2 animate-spin opacity-60"})]})})]})}export{h as P};
